<div class="h-screen flex bg-gray-100">
  <!-- Fixed Navigation Sidebar -->
  <div class="fixed left-0 top-0 h-screen w-full md:w-72 flex-shrink-0 p-3 md:p-4 overflow-hidden z-40">
    <app-navigation></app-navigation>
  </div>

  <!-- Main Content Area with Scroll -->
  <div class="flex-1 ml-0 md:ml-72 p-4 md:p-6 lg:p-8 overflow-y-auto h-screen">
    <!-- Header -->
    <app-header [title]="'File Management'"></app-header>

    <!-- Action Bar -->
    <div class="relative flex w-full p-4 justify-between items-center rounded-lg bg-white shadow-card mt-6 min-h-14">
      <button type="button" class="flex h-10 px-3 py-1.5 items-center gap-2 rounded bg-gray-100 hover:bg-gray-200">
        <span class="text-gray-700 text-base font-medium">Filters</span>
        <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M3 7.5L15 7.5M6 12L15 12M0 3L15 3" stroke="#6B7280" stroke-width="1.5" stroke-linecap="round"/>
        </svg>
      </button>

      <div class="flex items-center gap-3">
        <button type="button" (click)="toggleSettings()" class="flex h-10 px-3 py-1.5 items-center gap-2 rounded bg-gray-100 hover:bg-gray-200">
          <span class="text-gray-700 text-base font-medium">Settings</span>
          <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M9 11.25C10.2426 11.25 11.25 10.2426 11.25 9C11.25 7.75736 10.2426 6.75 9 6.75C7.75736 6.75 6.75 7.75736 6.75 9C6.75 10.2426 7.75736 11.25 9 11.25Z" stroke="#6B7280" stroke-width="1.5"/>
            <path d="M14.3175 11.25C14.1405 11.5923 14.1405 12.0077 14.3175 12.35L14.9887 13.5C15.1657 13.8423 15.5812 14.0077 15.9275 13.85L16.6987 13.5C17.0449 13.3423 17.2895 12.9846 17.2895 12.6V11.4C17.2895 11.0154 17.0449 10.6577 16.6987 10.5L15.9275 10.15C15.5812 9.99231 15.1657 10.1577 14.9887 10.5L14.3175 11.25Z" stroke="#6B7280" stroke-width="1.5"/>
          </svg>
        </button>

        <button type="button" routerLink="/new-file" class="flex h-10 px-3 py-1.5 items-center gap-2 rounded bg-orange-500 hover:bg-orange-600">
          <span class="text-white text-base font-medium">New File</span>
          <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M9 3.75V14.25M3.75 9H14.25" stroke="white" stroke-width="1.5" stroke-linecap="round"/>
          </svg>
        </button>
      </div>

      <!-- Settings Dropdown Panel -->
      <div *ngIf="showSettings" class="absolute right-0 top-16 z-20 w-[420px]">
        <div class="rounded-lg border border-dashed border-gray-300 bg-white shadow-xl p-4">
          <div class="flex items-center justify-between mb-2">
            <div class="text-gray-900 font-semibold">Section Settings</div>
            <button type="button" class="w-8 h-8 rounded-md border text-gray-600 bg-white" (click)="closeSettings()">âœ•</button>
          </div>
          <div class="rounded-md border border-dashed border-gray-300 p-3">
            <div class="text-primary-700 font-semibold text-center mb-3">Dropdown Management</div>
            <div class="flex flex-col gap-3">
              <button type="button" class="flex items-center justify-between px-4 py-4 rounded-lg border bg-gray-50 hover:bg-gray-100">
                <span class="text-gray-800 font-medium">Sector</span>
                <span class="w-7 h-7 grid place-items-center rounded bg-primary-700 text-white text-lg">+</span>
              </button>
              <button type="button" class="flex items-center justify-between px-4 py-4 rounded-lg border bg-gray-50 hover:bg-gray-100">
                <span class="text-gray-800 font-medium">Category</span>
                <span class="w-7 h-7 grid place-items-center rounded bg-primary-700 text-white text-lg">+</span>
              </button>
              <button type="button" class="flex items-center justify-between px-4 py-4 rounded-lg border bg-gray-50 hover:bg-gray-100">
                <span class="text-gray-800 font-medium">Sub Category</span>
                <span class="w-7 h-7 grid place-items-center rounded bg-primary-700 text-white text-lg">+</span>
              </button>
              <button type="button" class="flex items-center justify-between px-4 py-4 rounded-lg border bg-gray-50 hover:bg-gray-100">
                <span class="text-gray-800 font-medium">Data Types</span>
                <span class="w-7 h-7 grid place-items-center rounded bg-primary-700 text-white text-lg">+</span>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Segmented Tabs -->
    <div class="flex w-full items-center rounded-full bg-gray-100 shadow-card mt-5 min-h-12 p-1">
      <button type="button" (click)="setTab('all')" class="px-6 h-10 flex items-center rounded-full" [ngClass]="activeTab==='all' ? 'bg-white shadow-card text-primary-600 font-semibold' : 'text-gray-500'">All ({{ counts.all }})</button>
      <button type="button" (click)="setTab('active')" class="px-6 h-10 flex items-center rounded-full" [ngClass]="activeTab==='active' ? 'bg-white shadow-card text-primary-600 font-semibold' : 'text-gray-500'">Active ({{ counts.active }})</button>
      <button type="button" (click)="setTab('draft')" class="px-6 h-10 flex items-center rounded-full" [ngClass]="activeTab==='draft' ? 'bg-white shadow-card text-primary-600 font-semibold' : 'text-gray-500'">Draft ({{ counts.draft }})</button>
      <button type="button" (click)="setTab('archived')" class="px-6 h-10 flex items-center rounded-full" [ngClass]="activeTab==='archived' ? 'bg-white shadow-card text-primary-600 font-semibold' : 'text-gray-500'">Archived ({{ counts.archived }})</button>
    </div>

    <!-- File List -->
    <div class="flex p-6 items-start rounded-lg bg-white mt-5 w-full">
      <div class="flex w-full flex-col gap-4">
        <div class="relative flex flex-col lg:flex-row items-start lg:items-center justify-between gap-4 rounded-lg bg-gray-50 p-4" *ngFor="let f of filteredFiles">
          <div class="absolute -left-3 lg:-left-4 top-4">
            <input type="checkbox" class="w-4 h-4 accent-primary-600 rounded border-gray-400" />
          </div>
          <div class="flex flex-col gap-2 pr-4">
            <div class="flex items-center gap-2">
              <span class="text-gray-800 font-medium">{{ f.name }}</span>
              <span class="px-2 py-0.5 rounded-md bg-status-draftBg text-status-draft text-xs font-medium capitalize">{{ f.status }}</span>
            </div>
            <span class="text-gray-600 text-sm">Last Updated: {{ f.lastUpdated }}</span>
            <div class="flex items-center gap-2">
              <span class="px-2 py-0.5 rounded border border-status-operational bg-status-operationalBg text-status-operational text-[10px]">Energy</span>
              <span class="px-2 py-0.5 rounded border border-teal-500 bg-teal-50 text-teal-500 text-[10px]">Electricity</span>
            </div>
          </div>
          <div class="flex flex-col items-end gap-3 w-full lg:w-auto">
            <div class="flex flex-wrap gap-2 justify-start lg:justify-end">
              <button type="button" class="flex items-center gap-2 px-3 h-8 rounded-md border border-gray-200 bg-white text-sm">
                <span>User Assign</span>
              </button>
              <button type="button" class="flex items-center gap-2 px-3 h-8 rounded-md border border-gray-200 bg-white text-sm">
                <span>Manual</span>
              </button>
              <button type="button" class="flex items-center gap-2 px-3 h-8 rounded-md border border-gray-200 bg-white text-sm">
                <span>Edit File</span>
              </button>
            </div>
            <div class="flex items-center gap-3">
              <div class="flex items-center gap-2 select-none">
                <div class="w-[59px] h-[25px] rounded-full bg-gray-100 relative">
                  <div class="w-5 h-5 rounded-full bg-gray-300 absolute left-1 top-1"></div>
                </div>
                <span class="text-gray-800 text-sm opacity-80">Activate</span>
              </div>
              <button type="button" class="flex items-center px-3 h-8 rounded-md bg-red-100">
                <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6 19C5.45 19 4.97917 18.8042 4.5875 18.4125C4.19583 18.0208 4 17.55 4 17V7H3V5H7V4H11V5H15V7H14V17C14 17.55 13.8042 18.0208 13.4125 18.4125C13.0208 18.8042 12.55 19 12 19H6ZM12 7H6V17H12V7ZM7 15.5H8.5V8.5H7V15.5ZM9.5 15.5H11V8.5H9.5V15.5Z" fill="#CE5212"/></svg>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
